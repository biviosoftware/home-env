#!/bin/bash
(set -o igncr) &>/dev/null && set -o igncr && export SHELLOPTS # ignore cr
#
# DO NOT EDIT THIS FILE.

# How To Customize
#
# If you are running in RadiaSoft's Jupyter environemtn, create ~/jupyter/bashrc,
# which will be saved between server starts.
#
# If you are running on a Mac or Linux, create ~/.pre_bivio_bashrc
# or ~/.post_bivio_bashrc, which are executed as the first and last
# by this file (see below), respectively

# This avoids recursion on scripts called from ~/.bashrc
unset BASH_ENV

_bivio_bashrc_init() {
    # Source the files while avoiding recursion.
    #
    # pre-4 bash (and posix) has no $BASHPID so have to do this
    # very specific formula: https://stackoverflow.com/a/20726041
    local p=${BASHPID:-$(: ; bash -c 'echo $PPID')}
    if [[ " $p " =~ ${_bivio_bashrc_init_seen:-no-match} ]]; then
        echo "$HOME/.bashc: sourced in an infinite recursion, exiting 'source'" 1>&2
        return
    fi
    # subshells will get this variable so use process id as a sentinel
    _bivio_bashrc_init_seen+=" $p "
    local f
    for f in \
        "$HOME"/.pre_bivio_bashrc \
        /etc/bashrc \
        "$HOME"/src/*/home-env/bashrc.d/*.sh \
        "$HOME"/.post_bivio_bashrc \
        ; do
        if [[ -f $f ]]; then
            source "$f"
        fi
    done
}

_bivio_bashrc_init
unset -f _bivio_bashrc_init
